<!DOCTYPE html>
<html><head><meta charset="utf-8"><title>Shop</title></head>
<body>
  <h2>Shop</h2>
  <p><a href="/admin">Admin</a> | <a href="/cart">Cart (<%= cart.reduce((s,i)=>s+i.qty,0) %>)</a></p>
  <h3>Filter by Category</h3>
  <ul>
    <% parents.forEach(c => { %><li><%= c.name %></li><% }) %>
  </ul>
  <h4>Subcategories</h4>
  <ul>
    <% subs.forEach(c => { %><li><%= c.name %></li><% }) %>
  </ul>
  <h3>Products</h3>
  <ul>
    <% prods.forEach(p => { %>
      <li>
        <%= p.name %> - $<%= p.price %>
        (<%= p.category?.name %> / <%= p.subcategory?.name %>)
        <form method="post" action="/cart/add/<%= p._id %>" style="display:inline">
          <button type="submit">Add to Cart</button>
        </form>
      </li>
    <% }) %>
  </ul>
</body></html>
